<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.chart.*?>

<BorderPane xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.campuscare.controller.AnalyticsController"
            styleClass="dashboard-container"
            prefWidth="1200" prefHeight="700">
    
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="header">
            <padding><Insets top="15" right="20" bottom="15" left="20"/></padding>
            <Label text="ðŸ“Š Analytics Dashboard" styleClass="welcome-label"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button text="Back to Dashboard" onAction="#handleBack" styleClass="secondary-button"/>
        </HBox>
    </top>
    
    <center>
        <ScrollPane fitToWidth="true">
            <VBox spacing="30" alignment="TOP_CENTER">
                <padding><Insets top="30" right="30" bottom="30" left="30"/></padding>
                
                <!-- KPI Cards Row -->
                <HBox spacing="20" alignment="CENTER">
                    <VBox styleClass="stat-card" prefWidth="250">
                        <Label fx:id="totalRequestsLabel" text="0" style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                        <Label text="Total Requests" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
                    </VBox>
                    
                    <VBox styleClass="stat-card" prefWidth="250">
                        <Label fx:id="pendingLabel" text="0" style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #f39c12;"/>
                        <Label text="Pending" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
                    </VBox>
                    
                    <VBox styleClass="stat-card" prefWidth="250">
                        <Label fx:id="inProgressLabel" text="0" style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #3498db;"/>
                        <Label text="In Progress" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
                    </VBox>
                    
                    <VBox styleClass="stat-card" prefWidth="250">
                        <Label fx:id="completedLabel" text="0" style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #27ae60;"/>
                        <Label text="Completed" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
                    </VBox>
                </HBox>
                
                <!-- Charts Row -->
                <HBox spacing="20" alignment="CENTER" VBox.vgrow="ALWAYS">
                    <VBox styleClass="chart-card" HBox.hgrow="ALWAYS" alignment="CENTER">
                        <Label text="Requests by Category" styleClass="section-title"/>
                        <PieChart fx:id="categoryChart" legendSide="RIGHT" labelsVisible="false" minHeight="300"/>
                    </VBox>
                    
                    <VBox styleClass="chart-card" HBox.hgrow="ALWAYS" alignment="CENTER">
                        <Label text="Requests by Priority" styleClass="section-title"/>
                        <BarChart fx:id="priorityChart" legendVisible="false" minHeight="300">
                            <xAxis><CategoryAxis label="Priority" /></xAxis>
                            <yAxis><NumberAxis label="Count" /></yAxis>
                        </BarChart>
                    </VBox>
                </HBox>
                
                <!-- Performance Metrics -->
                <HBox spacing="20" alignment="CENTER">
                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS" alignment="CENTER">
                        <Label fx:id="avgResolutionLabel" text="0h" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #8e44ad;"/>
                        <Label text="Avg Resolution Time" style="-fx-text-fill: #7f8c8d;"/>
                    </VBox>
                    <VBox styleClass="stat-card" HBox.hgrow="ALWAYS" alignment="CENTER">
                        <Label fx:id="completionRateLabel" text="0%" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #16a085;"/>
                        <Label text="Completion Rate" style="-fx-text-fill: #7f8c8d;"/>
                    </VBox>
                </HBox>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>
